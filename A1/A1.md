### Assignment 1 Question 

```
For each sample

a.	What is the name of the malware family? 
b.	What method of malware persistence is in use for this sample?
c.	Are there any potential host-based indicators and/or network-based indicators for the malware? 
d.	Any special observations about this sample after it was executed? 
e.	Devise/Deploy a method to extract the malware configuration file for similar samples. Provide a step-by-step explanation and any references that was used. 

```

# Sample A: 
a. XtremeRAT (or XRAT) is a family of Remote Access Trojan. According to Fireeye, "The XtremeRAT was developed by “xtremecoder” and has been available since at least 2010.  Written in Delphi, the code of XtremeRAT is shared amongst several other Delphi RAT projects including SpyNet, CyberGate, and Cerberus. The RAT is available for free; however, the developer charges 350 Euros for the source code.  Unfortunately for xtremecoder, the source code has been leaked online.  The current version is Xtreme 3.6, however, there are a variety of “private” version of this RAT available as well. As such, the official version of this RAT and its many variants are used by a wide variety of actors." 

 This RAT has the following capabilities (from Fireeye report):
    
    Interact with the victim via a remote shell (ShellExecuteW)
    Upload/download files (URLDownloadToCacheFileW,FtpPutFileW,Ftp-related functions)
    Interact with the registry (SHDeleteKeyW,SHDeleteValueW,RegQueryValueExA,RegOpenKeyExA,REgCloseKey)
    Manipulate running processes and services (CreateThread,CreateProcessW,CreateFileW,CreateEventA,)
    Capture images of the desktop (GetDesktopWindow)
    GetClipboard data, GetKeyboardstate -- but strangely enough not a keylogger 
    Record from connected devices, such as a webcam or microphone 

A full description of the malware functionalities can be found here page9 of the whitepaper

b. Persistence: 
https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/XTRAT 
It copies itself to the following location: 

    %System%\System\System.exe
    %User Temp%\ie4uinit.exe

It injects itself into the following processes as part of its memory residency routine:

    msedge.exe
    svchost.exe


c. Indicators:

 
The RAT contains an RC4 encrypted config files that contain several useful information (under  %APPDATA%\Roaming\BlackMamba_Mutex.cfg). 

There is two approaches to decrypt this file:
1. Ollygdb it till the point it write the file to disk , extract the file, RC4 decrypt using string "CONFIG" and read the content
2. Use Malwarelu method of extracting it directly from the resource section, and the rest is the same. 

A step by step explanation of method 1




A step by step explanation of method 2:
the link is here https://malware.lu/articles/2012/07/22/xtreme-rat-analysis.html . Just use their xtremerat_config.py on the executable. 

The file is here ./a_RC4_decrypted_cfg.txt 

We see the following info as mentioned:


    Name of the installed backdoor file
    Directory under which the backdoor file is installed
    Which process it will inject into (if specified)
    CnC information: 111.65.40.69 and 112.66.17.12, GETS to 1234567890.functions 
    FTP information for sending stolen keystroke data to ftp.ftpserver.com 
    Mutex name of the master process,
    ID and group name which are used by the actors for organizational purposes


 Check backdoor here
 https://blog.malwarebytes.com/detections/backdoor-xtrat/ 

Potential host: 123456789ABCDEF as the password
Potential network:

b. Persistence 


https://www.sans.org/reading-room/whitepapers/malicious/xtremerat-unicode-breaks-35897 

 